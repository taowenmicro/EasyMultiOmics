% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stacked_bar_by_custom_class_v.R
\name{stacked_bar_by_custom_class_v}
\alias{stacked_bar_by_custom_class_v}
\title{Stacked Barplots by Custom Abundance Classes (Column/Row layout, Zoomed Medium/Low)}
\usage{
stacked_bar_by_custom_class_v(
  ps,
  rank = "Phylum",
  group = "Group",
  thresholds = c(1, 0.1),
  n_each = c(5, 5, 5),
  tran = TRUE,
  y_max_high = 100,
  y_max_medium = NULL,
  y_max_low = NULL,
  zoom_exclude_other = TRUE,
  other_label = "Other",
  arrange = c("column", "row"),
  panel_heights = c(1.2, 1, 1),
  panel_widths = c(1, 1.2, 1.2)
)
}
\arguments{
\item{ps}{A \code{phyloseq} object.}

\item{rank}{Character. Taxonomic rank to aggregate (e.g. "Phylum","Genus").}

\item{group}{Character. Sample metadata column for grouping (default "Group").}

\item{thresholds}{Numeric length-2 vector in percent, e.g. \code{c(1, 0.1)}:
High >= max(thresholds); Medium in [min, max); Low < min. Order-insensitive.}

\item{n_each}{Integer length-3, number of representatives to keep in \code{c(High,Medium,Low)}.
Default \code{c(5, 5, 5)}.}

\item{tran}{Logical; if TRUE, transform counts to per-sample relative abundances first. Default TRUE.}

\item{y_max_high, y_max_medium, y_max_low}{Numerics or NULL; panel x upper limits（bars are horizontal）.
If NULL for Medium/Low, limits are tightly auto-estimated.}

\item{zoom_exclude_other}{Logical; when auto-zooming Medium/Low, exclude \code{other_label}
from computing the max to better magnify selected taxa. Default TRUE.}

\item{other_label}{Character; label for non-selected taxa (default "Other").}

\item{arrange}{Character, \code{"column"} (3 panels stacked vertically) or \code{"row"} (3 panels in a row).
Default \code{"column"}.}

\item{panel_heights}{Numeric length-3; relative heights for \code{c(High,Medium,Low)} when \code{arrange="column"}.
Default \code{c(1.2, 1, 1)}.}

\item{panel_widths}{Numeric length-3; relative widths for \code{c(High,Medium,Low)} when \code{arrange="row"}.
Default \code{c(1, 1.2, 1.2)} so Medium/Low get more space.}
}
\value{
A list with \code{high}, \code{medium}, \code{low}, \code{combined}, \code{table},
  and \code{y_limits} (actually the x-limits used by horizontal bars).
}
\description{
Aggregate a \code{phyloseq} object to a given taxonomic \code{rank}, convert to
relative abundance (percent), split taxa into High/Medium/Low classes by user
thresholds, select representative taxa per class, and draw Nature-style stacked
barplots. Panels can be arranged in a single column (default) or a single row.
Medium/Low panels use tighter auto-zoom on the abundance axis to highlight trends.
Legends are collected at the bottom; only the first panel keeps y-axis tick labels.
}
