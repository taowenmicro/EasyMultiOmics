% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/volcano_plot_metm.R
\name{volcano_plot_metm}
\alias{volcano_plot_metm}
\title{Volcano plot with symmetric x-axis for edgeR/DE-style results}
\usage{
volcano_plot_metm(
  x1,
  p_cut = 0.05,
  lfc_cut = 1,
  top_n = 8,
  shade = FALSE,
  sym_q = 0.995,
  base_size = 12
)
}
\arguments{
\item{x1}{A `data.frame` with at least the columns `logFC`, `p`, and `level`.
If a `Genus` column is present it will be used for labels; otherwise row names are used.}

\item{p_cut}{Significance threshold used to draw the horizontal reference line. Default `0.05`.}

\item{lfc_cut}{Absolute log2 fold-change threshold used to draw the vertical reference lines. Default `1`.}

\item{top_n}{Maximum number of labeled points per direction (enriched/depleted). Default `8`.}

\item{shade}{Logical; if `TRUE`, adds light shaded panels beyond \code{Â±lfc_cut}.
Default `FALSE` (no background shading).}

\item{sym_q}{Quantile used to set the symmetric x-limits robustly (e.g. `0.995` = 99.5th percentile). Default `0.995`.}

\item{base_size}{Base font size passed to `ggplot2::theme_minimal()`. Default `12`.}
}
\value{
Prints a `ggplot` object and (invisibly) returns a list with:
\describe{
  \item{plot}{The ggplot object.}
  \item{data}{Processed plotting data.}
  \item{data_sig}{The subset of labeled significant points.}
}
}
\description{
Draws a publication-grade volcano plot for differential-abundance results.
The x-axis is made symmetric around 0 using a robust quantile, and the
top labels from each direction (enriched/depleted) are placed with
collision-avoiding repelled text.
}
\details{
- Expected `level` values are `"enriched"`, `"depleted"`, and `"nosig"`.
- If any p-values are zero (leading to `Inf` on `-log10(p)`), those points are capped
  to the maximum finite y-value + 1 to keep the plot finite.
- If a function named `theme_cell()` exists in the search path, it will be added on top
  of the theme (useful for lab-specific styling). Otherwise it is ignored.
}
\examples{
\dontrun{
# Suppose 'res' is a data.frame with columns: logFC, p, level, Genus
out <- volcano_plot_metm(res, p_cut = 0.05, lfc_cut = 1, top_n = 10)
out$plot
}

}
