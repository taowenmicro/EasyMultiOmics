% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apply_rmt_scale_free2.R
\name{apply_rmt_scale_free2}
\alias{apply_rmt_scale_free2}
\title{Apply RMT + Scale-free threshold analysis}
\usage{
apply_rmt_scale_free2(cor_matrix, plot_results = TRUE)
}
\arguments{
\item{cor_matrix}{A numeric correlation matrix (square, symmetric).}

\item{plot_results}{Logical, whether to plot analysis results (default = TRUE).}
}
\value{
A list containing:
\describe{
  \item{threshold_analysis}{A data.frame with threshold and computed metrics.}
  \item{optimal_threshold}{The selected optimal threshold value.}
  \item{p}{ggplot object of the analysis visualization.}
}
}
\description{
This function performs Random Matrix Theory (RMT) analysis combined with
scale-free property evaluation to select an optimal correlation threshold
for network construction. It scans a series of thresholds, calculates RMT
metrics (nearest-neighbor spacing distribution, eigenvalue ratios, spectral
density) and fits power-law to degree distributions.
}
\details{
The function works in several steps:
\enumerate{
  \item \strong{RMT analysis:} For each threshold, build adjacency matrix
        and compute eigenvalue-based RMT metrics (NNSD, eigenvalue ratio,
        spectral density).
  \item \strong{Scale-free fitting:} Fit a power-law distribution to the
        degree distribution of the network and estimate gamma exponent.
  \item \strong{Threshold selection:} Integrate RMT and scale-free metrics
        to select an optimal threshold, maximizing
        \deqn{NNSD / |gamma - 2.5|}.
  \item \strong{Visualization:} If \code{plot_results = TRUE}, plot NNSD,
        gamma, and edge density across thresholds, with vertical line
        indicating optimal threshold.
}
}
\examples{
\dontrun{
  # Example with random correlation matrix
  mat <- matrix(rnorm(100*100), 100, 100)
  cor_mat <- cor(mat)
  res <- apply_rmt_scale_free2(cor_mat)
  res$optimal_threshold
  res$p
}

}
