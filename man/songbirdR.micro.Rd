% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/songbirdR.micro.R
\name{songbirdR.micro}
\alias{songbirdR.micro}
\title{Songbird-like multinomial regression in pure R}
\usage{
songbirdR.micro(
  ps,
  group = "Group",
  alpha = 0,
  lambda = NULL,
  pseudo_p = TRUE,
  collapse = TRUE,
  sig_alpha = 0.05
)
}
\arguments{
\item{ps}{A phyloseq object}

\item{group}{Column name in sample_data for grouping variable}

\item{alpha}{Elastic-net mixing parameter (default 0 = ridge, 1 = lasso)}

\item{lambda}{Regularization parameter (default = lambda.min chosen by CV)}

\item{pseudo_p}{Logical; if TRUE, output a pseudo p-value based on rank (default FALSE)}
}
\value{
A list with:
\itemize{
  \item tab.songbirdR: tidy coefficient table (all features, all groups)
  \item diff.tab: standardized output (OTU, Group, method, coef, adjust.p/pseudo_p)
}
}
\description{
This function mimics Songbird (QIIME2, Python) using glmnet multinomial regression.
It outputs feature coefficients (log-fold change estimates). Optionally, a "pseudo_p"
score is added based on coefficient ranking.
}
\examples{
\dontrun{
  library(phyloseq)
  data(GlobalPatterns)
  # subset a small dataset
  ps.sub <- prune_samples(sample_data(GlobalPatterns)$SampleType \%in\% c("Feces","Skin"), GlobalPatterns)
  ps.sub <- prune_taxa(taxa_sums(ps.sub) > 100, ps.sub)

  res <- songbirdR.micro(ps.sub, group="SampleType", alpha=0, pseudo_p=TRUE)
  head(res$diff.tab)
}
}
