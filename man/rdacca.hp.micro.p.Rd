% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rdacca.hp.micro.p.R
\name{rdacca.hp.micro.p}
\alias{rdacca.hp.micro.p}
\title{Hierarchical Partitioning with Permutations for RDA, CCA, and db-RDA}
\usage{
rdacca.hp.micro.p(OTU = mite, env = env1, cca = FALSE, dbRDA = FALSE, rep = 9)
}
\arguments{
\item{OTU}{A data frame or matrix of OTU abundance data, where rows represent samples and columns represent OTUs.}

\item{env}{A data frame of environmental variables, where rows correspond to samples and columns represent variables.}

\item{cca}{A logical value indicating whether to perform hierarchical partitioning using Canonical Correspondence Analysis (CCA). Default is `FALSE`.}

\item{dbRDA}{A logical value indicating whether to perform hierarchical partitioning using Distance-based Redundancy Analysis (db-RDA). Default is `FALSE`.}

\item{rep}{An integer specifying the number of permutations for the permutation test. Default is `9`.}
}
\value{
A list containing:
\itemize{
  \item `p`: A ggplot2 object visualizing the hierarchical partitioning results for RDA.
  \item `dat`: A data frame containing the hierarchical partitioning results for RDA.
  \item `p1`: A ggplot2 object visualizing the hierarchical partitioning results for CCA (if `cca = TRUE`).
   \item `p2`: A ggplot2 object visualizing the hierarchical partitioning results for db-RDA (if `dbRDA = TRUE`).
}
}
\description{
The `rdacca.hp.micro.p` function performs hierarchical partitioning with permutation tests to evaluate the contribution of environmental variables to variance in OTU abundance data. The function supports Redundancy Analysis (RDA), Canonical Correspondence Analysis (CCA), and Distance-based Redundancy Analysis (db-RDA). It outputs bar plots and permutation results for each method.
}
\details{
The function performs hierarchical partitioning for variance decomposition and applies permutation tests to estimate the significance of contributions from each environmental variable. The function supports three methods:
\enumerate{
  \item **RDA (Redundancy Analysis)**:
    - Applies Hellinger transformation to OTU data.
    - Performs permutation-based hierarchical partitioning using `permu.hp`.
    - Generates a bar plot showing the contributions of each environmental variable.
  \item **CCA (Canonical Correspondence Analysis)** (if `cca = TRUE`):
    - Uses the original OTU abundance data without transformation.
    - Performs hierarchical partitioning with permutation tests.
    - Generates a bar plot showing the contributions of each environmental variable.
  \item **db-RDA (Distance-based Redundancy Analysis)** (if `dbRDA = TRUE`):
    - Computes Bray-Curtis distance from the OTU abundance data.
    - Performs hierarchical partitioning with permutation tests.
    - Generates a bar plot showing the contributions of each environmental variable.
}
}
\examples{
\dontrun{
res = rdacca.hp.micro(OTU = ps.tem \%>\% filter_OTU_ps(500) \%>\%vegan_otu() \%>\% as.data.frame(), env = ftab[,1:5], cca = FALSE)
}
}
\author{
Tao Wen \email{2018203048@njau.edu.cn},
Peng-Hao Xie \email{2019103106@njqu.edu.cn}
}
