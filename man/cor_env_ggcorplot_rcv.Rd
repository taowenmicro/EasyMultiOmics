% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cor_env_ggcorplot_rcv.R
\name{cor_env_ggcorplot_rcv}
\alias{cor_env_ggcorplot_rcv}
\title{Correlation Analysis and Visualization Based on Row Coefficient of Variation (RCV)}
\usage{
cor_env_ggcorplot_rcv(
  ps = ps.tem,
  jj = NULL,
  tran = TRUE,
  Top = 10,
  env1 = ftab,
  label = TRUE,
  col_cluster = TRUE,
  row_cluster = TRUE,
  method = "spearman",
  r.threshold = 0,
  p.threshold = 0,
  theme.size = 10
)
}
\arguments{
\item{ps}{A `phyloseq` object containing OTU/taxa abundance data and sample metadata.}

\item{jj}{A taxonomic rank (e.g., "Genus", "Family") for aggregating OTUs. If `NULL`, no aggregation is performed. Default is `NULL`.}

\item{tran}{A logical value indicating whether to transform OTU counts into relative abundances. Default is `TRUE`.}

\item{Top}{An integer specifying the number of top OTUs to retain based on row Coefficient of Variation (RCV). Default is `10`.}

\item{env1}{A data frame of environmental variables, where rows are samples and columns are variables.}

\item{label}{A logical value indicating whether to label the rows and columns in the plot. Default is `TRUE`.}

\item{col_cluster}{A logical value specifying whether to perform hierarchical clustering on the columns. Default is `TRUE`.}

\item{row_cluster}{A logical value specifying whether to perform hierarchical clustering on the rows. Default is `TRUE`.}

\item{method}{A character string specifying the correlation method (`"spearman"`, `"pearson"`, or `"kendall"`). Default is `"spearman"`.}

\item{r.threshold}{A numeric value specifying the minimum correlation coefficient for displaying results. Default is `0`.}

\item{p.threshold}{A numeric value specifying the maximum p-value for displaying results. Default is `0`.}

\item{theme.size}{An integer specifying the text size for axis labels and legends. Default is `10`.}
}
\value{
A list containing:
\itemize{
  \item `p1`: A heatmap visualizing the correlations between environmental variables and OTUs/taxa.
  \item `p2`: A scatterplot-style visualization of the correlations.
  \item `env2`: A matrix of the top OTUs/taxa retained for the analysis based on RCV.
  \item `data`: A long-format data frame of the correlation results used for plotting.
}
}
\description{
The `cor_env_ggcorplot_rcv` function computes correlations between environmental variables and top OTUs/taxa
(selected based on row Coefficient of Variation, RCV). The function generates heatmaps and scatterplots to visualize
the correlations, with optional hierarchical clustering for rows and columns.
}
\examples{
\dontrun{
result <- cor_env_ggcorplot_rcv(ps = ps, env1 = env1, Top = 5, method = "spearman")
}
}
\author{
Tao Wen \email{2018203048@njau.edu.cn},
Peng-Hao Xie \email{2019103106@njqu.edu.cn}
}
