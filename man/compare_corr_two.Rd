% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utls.network.R
\name{compare_corr_two}
\alias{compare_corr_two}
\title{Compare two correlation matrices and their derived networks}
\usage{
compare_corr_two(
  A,
  B,
  tol = 1e-06,
  delta = 0.1,
  thr = NULL,
  edge_thr = 0.3,
  edge_rule = c("abs", "pos", "neg"),
  same_sign_only = FALSE
)
}
\arguments{
\item{A}{A square numeric correlation matrix with row and column names.}

\item{B}{A square numeric correlation matrix with row and column names.}

\item{tol}{Numeric scalar; tolerance within which correlations are treated
as "equal".}

\item{delta}{Numeric scalar; \code{|Î”r|} threshold to classify edges as
increased or decreased (\code{r_B - r_A > delta} or
\code{r_B - r_A < -delta}).}

\item{thr}{Optional numeric; absolute correlation threshold for classifying
"strong" correlations when constructing the \code{$strong} component of
the output.}

\item{edge_thr}{Numeric; threshold used to define network edges when
comparing networks (e.g. \code{0.3}, \code{0.5}, \code{0.7}).}

\item{edge_rule}{Character; one of \code{"abs"}, \code{"pos"} or
\code{"neg"}:
\itemize{
  \item \code{"abs"}: treat edges as present when \code{|r| >= edge_thr}.
  \item \code{"pos"}: treat edges as present when \code{r >= edge_thr}.
  \item \code{"neg"}: treat edges as present when \code{r <= -edge_thr}.
}}

\item{same_sign_only}{Logical; if \code{TRUE}, shared edges must have the
same sign in \code{A} and \code{B} to be counted as shared.}
}
\value{
A list with elements:
\itemize{
  \item \code{$summary}: Named numeric counts (total edges, changed,
        sign flips, increased, decreased, NA patterns, and counts of
        edges in each network and shared/unique edges under the chosen
        \code{edge_thr}).
  \item \code{$edges}: Data frame with one row per unique edge (upper
        triangle), including correlations in both matrices, difference,
        flags, and network membership.
  \item \code{$changed}: Subset of \code{edges} where correlations differ
        by more than \code{tol} and are not NA in only one matrix.
  \item \code{$flipped}: Subset of \code{edges} where correlation sign
        differs between \code{A} and \code{B}.
  \item \code{$increased}: Subset of \code{edges} with
        \code{r_B - r_A > delta}.
  \item \code{$decreased}: Subset of \code{edges} with
        \code{r_B - r_A < -delta}.
  \item \code{$shared_edges}: Subset of \code{edges} present in both
        networks under the specified \code{edge_thr} and \code{edge_rule}.
  \item \code{$<Aname>_only_edges}: Subset of \code{edges} present only
        in network \code{A}.
  \item \code{$<Bname>_only_edges}: Subset of \code{edges} present only
        in network \code{B}.
  \item \code{$strong}: Optional list with strong-correlation comparisons
        if \code{thr} is provided.
  \item \code{$top_changes}: Edges with the largest absolute changes
        in correlation.
  \item \code{$params}: List of parameters used in the comparison
        (names of matrices, thresholds, etc.).
}
}
\description{
This function compares two correlation matrices (\code{A} and \code{B})
that share the same set of variables (node IDs) and differ only in the
correlation values. It provides:
\itemize{
  \item Per-edge differences in correlation (\code{r_B - r_A}).
  \item Flags for equality within a tolerance, sign flips, increases and decreases.
  \item Network-level comparison based on a correlation threshold
        (\code{edge_thr}) and edge rule (\code{"abs"}, \code{"pos"},
        or \code{"neg"}).
  \item Counts of shared and condition-specific edges.
  \item Optional comparison of "strong" correlations using \code{thr}.
}
}
\details{
The input matrices must:
\itemize{
  \item Be square numeric matrices.
  \item Have identical row and column names.
  \item Represent the same variables in the same order.
}

The output includes a summary list with counts, a per-edge data frame
(\code{$edges}) containing the correlations in both matrices and various
flags, as well as convenience subsets (e.g. \code{$changed},
\code{$flipped}, \code{$shared_edges}, \code{$<Aname>_only_edges},
\code{$<Bname>_only_edges}). The correlation columns in \code{edges}
are named \code{r_<Aname>} and \code{r_<Bname>} based on how the matrices
were passed (e.g. \code{mat[["WT"]]}, \code{mat[["OE"]]}).
}
\examples{
# Assume cor_WT and cor_OE are aligned correlation matrices
# with identical row/column names:
# res <- compare_corr_two(cor_WT, cor_OE, edge_thr = 0.6, edge_rule = "abs")
# head(res$shared_edges)

}
